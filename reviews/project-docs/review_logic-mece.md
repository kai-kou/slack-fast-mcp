# レビュー結果: ② 論理・MECE（What）

**レビュアー**: 論理・MECEレビュアー
**対象ドキュメント**: requirements.md / architecture.md / slack-app-setup.md
**レビュー日**: 2026-02-10

---

## 総合評価: B+（論理構造は良好、MECE上の欠落あり）

ドキュメント全体の論理構成は堅実だが、仕様の網羅性とドキュメント間の整合性にいくつかの欠落・矛盾がある。

---

## 1. 論理整合性の検証

### 1.1 requirements.md 内部の論理整合性

| 検証項目 | 結果 | 詳細 |
|---|---|---|
| ユーザー要件 → 要件分析 | ◎ | 各要件に対して技術的解決策が1対1で対応 |
| 要件分析 → MCP ツール仕様 | ○ | 機能要件はカバーされているが、「投稿内容を確認できる」の仕様が不十分（後述） |
| MCP ツール仕様 → 設定ファイル仕様 | ◎ | channel パラメータのデフォルト値が設定仕様と整合 |
| 設定ファイル仕様 → セキュリティ考慮 | ◎ | トークン管理の方針が一貫 |

### 1.2 requirements.md → architecture.md の整合性

| 検証項目 | 結果 | 詳細 |
|---|---|---|
| MCP ツール仕様 → コンポーネント設計 | ◎ | 3つのツールがMCP Server設計に反映 |
| 設定優先順位 | ◎ | 両ドキュメントで同一の4段階優先順位 |
| エラーハンドリング方針 | ○ | requirements.md のエラーカテゴリとarchitecture.md のAppError構造体は整合するが、具体的なマッピングが不在 |
| CLI コマンド仕様 → CLI Layer設計 | △ | requirements.md のCLI仕様は詳細だが、architecture.md のCLI Layer設計は薄い（後述） |

### 1.3 requirements.md → slack-app-setup.md の整合性

| 検証項目 | 結果 | 詳細 |
|---|---|---|
| 必要スコープ一覧 | ◎ | 両ドキュメントで一致 |
| 設定方法 | ○ | 概ね一致だが、グローバル設定ファイルの記述に微妙な差異（後述） |
| トラブルシューティング | ○ | setup.md のエラーは requirements.md のエラーケースをカバー |

---

## 2. MECE検証（漏れ・重複の検出）

### 2.1 機能の漏れ（Missing）

| # | 指摘 | 重要度 | 説明 |
|---|---|---|---|
| L-1 | **「投稿内容を確認できる」の仕様が不完全** | 高 | ユーザー要件に「投稿内容を確認できる」とあるが、`slack_get_history` は「チャンネル履歴取得」であり、**特定の投稿の確認（例: 自分が投稿した内容の即時確認）** のユースケースが明確でない。投稿直後の確認は `slack_post_message` のレスポンスで十分なのか、それとも別途 `slack_get_message` のような単一メッセージ取得が必要かの検討が不在 |
| L-2 | **メッセージ文字数制限の未記述** | 中 | Slack APIの `chat.postMessage` にはメッセージ長制限（40,000文字）があるが、要件定義・設計書のいずれにも記述なし。バリデーション仕様が欠落 |
| L-3 | **Slack Markdownとの互換性仕様が未定義** | 中 | 「Markdown対応」と記述されているが、Slackの mrkdwn 形式は標準Markdownとは異なる。LLMが生成する標準Markdownをどう変換するか（または変換しないか）の方針が未記述 |
| L-4 | **`conversations.list` のページネーション** | 中 | チャンネル名解決で `conversations.list` を使用するが、ワークスペースのチャンネル数が多い場合のページネーション処理の仕様が未記述 |
| L-5 | **Windows対応の具体的検討が不足** | 中 | 「Mac、Windowsでも実行できる」要件があるが、Windows固有の考慮事項（パス区切り、設定ファイルの場所 `%APPDATA%` vs `~/.config`、curl+chmod の代替等）がarchitecture.mdで未検討 |

### 2.2 論理的矛盾・不整合

| # | 指摘 | 重要度 | 説明 |
|---|---|---|---|
| L-6 | **グローバル設定ファイルのパス不整合** | 低 | requirements.md では `~/.config/slack-fast-mcp/config.json` と記述。Windowsでのパスが未定義。XDG Base Directory準拠かどうかも不明 |
| L-7 | **チャンネルID判定ロジックの不完全性** | 中 | architecture.md で「"C"で始まる → チャンネルID」としているが、Slackのチャンネルプレフィックスは `C`（パブリック）だけでなく `G`（プライベート/マルチパーティDM）もある。`G` 始まりのチャンネルIDが正しく処理されない可能性 |
| L-8 | **`server.WithToolCapabilities(false)` の意図が不明** | 低 | architecture.md §4.3 で `WithToolCapabilities(false)` としているが、これはツールの変更通知を無効にする設定。なぜfalseなのかの理由が記述されていない |
| L-9 | **セットアップガイドのグローバル設定にトークン直書き** | 中 | slack-app-setup.md §5.3 でグローバル設定ファイルの例にトークンが直書きされている（`"token": "xoxb-xxxx-xxxx-xxxx"`）が、requirements.md §4.5 では「直書きしないことを推奨」「直書きの場合は警告表示」としている。ドキュメント間の推奨が矛盾 |

### 2.3 重複（Overlap）

| # | 指摘 | 重要度 | 説明 |
|---|---|---|---|
| L-10 | **Cursor MCP設定が3箇所に記述** | 低 | requirements.md（暗黙的）、architecture.md §7.3、slack-app-setup.md §6 に同様の設定例がある。変更時に全箇所の更新が必要で、不整合リスクがある |
| L-11 | **エラーケースの重複記述** | 低 | requirements.md の各ツールのエラーケースと §7 のエラーハンドリング方針に重複がある。一元化が望ましい |

---

## 3. 根拠の妥当性検証

### 3.1 技術選定の根拠

| 選定 | 根拠の妥当性 | コメント |
|---|---|---|
| Go言語 | ◎ | MCP Serverの毎回起動特性を踏まえた合理的な選択。定量的な比較（起動時間 ms 等）があるとさらに良い |
| mcp-go | ○ | 利用プロジェクト数1,020+は妥当な選択根拠だが、v1未到達のリスク評価がslack-goのみで、mcp-goには記述なし |
| cobra | ◎ | Go CLIのデファクトスタンダードという根拠は妥当 |
| 独自JSON設定 | ○ | viperの依存の大きさは事実だが、「起動速度への影響」の定量的根拠がない。体感的に差があるのか |

### 3.2 不足している根拠

| # | 指摘 | 説明 |
|---|---|---|
| L-12 | **レート制限の「影響なし」判断の根拠** | requirements.md §6.3 で「内部カスタムアプリは従来のレート制限が維持される」としているが、公式ドキュメントの参照リンクがない。この前提が誤っていた場合の影響が大きい |
| L-13 | **「最大3回」リトライの根拠** | なぜ3回なのかの説明がない。3回で十分とする根拠、または業界標準への参照が欲しい |

---

## 4. 推奨アクション（優先度順）

1. **【高】L-1: 「投稿内容を確認できる」要件の仕様明確化** — get_historyで十分か、単一メッセージ取得が必要かを判断・記述
2. **【高】L-7: チャンネルID判定ロジックの修正** — `C` だけでなく `G` プレフィックスも考慮するよう設計を修正
3. **【中】L-9: グローバル設定の例をトークン直書きから環境変数参照に修正** — slack-app-setup.md のサンプルをrequirements.mdの推奨に揃える
4. **【中】L-5: Windows対応の設計記述追加** — 設定ファイルパス、インストール手順のWindows対応を明記
5. **【中】L-2, L-3: 入力バリデーション仕様の追加** — メッセージ文字数制限、Markdown互換性の方針を記述
6. **【中】L-4: conversations.list ページネーション仕様の追加**
7. **【低】L-10, L-11: 重複記述の整理** — 単一ソースオブトゥルースの原則に従い、参照形式に変更
